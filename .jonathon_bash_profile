# Add following line to bash
# source ~/Projects/LinuxHelp/.jonathon_bash_profile
#----------git-----------
alias GitGraph='git log --graph --decorate --oneline --all' # --since=1.days || 1.years .... 
GitWhatTheHeckHappened() {
  git diff $1^ $1
}
GitPushToOrigin() {
  if [ -z "$CURRENT_BRANCH" ]; then
    echo "No branch set. Are you sure this is a git repository??"
  else
    git push --set-upstream origin "$CURRENT_BRANCH"
  fi
}
#----------git-----------

#----------search/replace-----------
Replace() {
  if [ "$#" -eq 2 ]; then
    find ./ -type f -exec sed -i 's/'$1'/'$2'/g' {} \;
  else
    echo "find ./ -type f -exec sed -i 's/$1/$2/g' {} \;"
  fi
}
ReplaceConfirmation() {
  if [ "$#" -eq 2 ]; then
    find ./ -type f -exec vi -c 's/'$1'/'$2'/gc' -c 'wq' {} \;
  else
    echo "find ./ -type f -exec sed -i 's/$1/$2/g' {} \;"
  fi
}
Rename() {
  if [[ $# -eq 2 ]]; then
    find ./ -name '*'$1'*' -exec bash -c 'mv "$0" "${0/'$1'/'$2'}"' {} \;
  else
    echo "need 2 argumens ($#) for find ./ -name '*$1*' -exec bash -c 'mv \"$0\" \"${0/$1/$2}\"' {} \;"
  fi
}
#----------search/replace-----------

#--------helpful git-------

PROMPT_COMMAND=set_prompt

function set_prompt {
# Shorten the path if it's too long (longer than $m)
local p=$(pwd) b s m=30 psssh=''
if [ -n "$SSH_CLIENT" ] || [ -n "$SSH_TTY" ]; then
  psssh="\[\e[94m\]${USER}@$(hostname | cut -d "." -f 1):"
  m=15
fi
p=${p/#$HOME/\~}
s=${#p}
while [[ $p != "${p//\/}" ]]&&(($s>$m))
do
  p=${p#/}
  [[ $p =~ \.?. ]]
  b=$b/${BASH_REMATCH[0]}
  p=${p#*/}
  ((s=${#b}+${#p}))
done
p=${b/\/~/\~}${b+/}$p

# Display user@hostname:pwd process
# echo -ne "\033]0;${USER}@${HOSTNAME}: ${p}\007"
# Fill in a git status data if in git repo
# mapfile -t l < <(git status --porcelain -b 2> /dev/null)
while IFS= read -r line; do
    l+=("$line")
done < <(git status --porcelain -b 2> /dev/null)
local psst="$psssh\[\e[39m\]$p" psen="\[\e[1;39m\]\$\[\e[0m\] "
# br -> branch, la -> local ahead, lb -> local behind, lc -> local commited, lu -> local uncommited, ln -> local new
local br="" la="" lb="" ln="" lu="" lad="" lc="" i
if [ ${#l} != '0' ]; then
  br=${l[0]:3} && br=${br%...*}
  la=${l[0]#*[ahead } && la=${la%% *} && [[ ${la:(-1)} != '#' ]] && la=${la:0:${#la}-1} || la=""
  lb=${l[0]#*behind } && lb=${lb%% *} && [[ ${lb:(-1)} != '#' ]] && lb=${lb:0:${#lb}-1} || lb=""
  for i in "${l[@]:1}"; do
    [[ ${i:1:1} == '?' ]] && ln='N'
    [[ ${i:1:1} == 'M' ]] && lu='U'
    [[ ${i:0:1} == 'A' ]] && lad='A'
    [[ ${i:0:1} == 'M' ]] && lc='C' # âˆ‚
  done

  unset l

  CURRENT_BRANCH="$br"
  local bashStuff="\[\e[38;5;104m\][$br\[\e[0;32m\]$la\[\e[1;33m\]$lb\[\e[0m\]\[\e[1;91m\]$ln\[\e[1;31m\]$lu\[\e[1;96m\]$lad\[\e[1;36m\]$lc\[\e[38;5;104m\]]\[\e[1;32m\]\e[0m\]"
  # Set prompt variable with git indicator
  if [ ${#CURRENT_BRANCH} -ge 10 ]; then
    PS1="$bashStuff\n$psst$psen"
  else
    PS1="$psst$bashStuff$psen"
  fi
else
  # Set prompt variable without git indicator
  PS1="$psst$psen"
  CURRENT_BRANCH=""
fi
}
#--------helpful git-------
